select s.toc, count(*)
from Schedules s
group by s.toc;

select distinct s.Status, s.Category, s.Speed, s.PowerType, s.OperatingCharacteristics, s.Catering
from schedules s
where s.toc = 'GW'
order by s.speed desc;


select s.retailserviceid, s.*
from schedules s
where s.toc = 'GW'
and s.RetailServiceId IN('GW512100',
'GW522000',
'GW612600',
'GW612800',
'GW612900',
'GW613000',
'GW613100',
'GW613200',
'GW613300',
'GW613400',
'GW613500',
'GW613600',
'GW613700',
'GW613900',
'GW614000',
'GW616500',
'GW616600',
'GW616700',
'GW616800',
'GW616900',
'GW617000',
'GW617100',
'GW617200',
'GW617300',
'GW617500',
'GW617600',
'GW617700',
'GW617800',
'GW617900',
'GW623200',
'GW623400',
'GW623500',
'GW623600',
'GW623800',
'GW623900',
'GW624000',
'GW624100',
'GW624300',
'GW624400',
'GW624500',
'GW624600',
'GW624800',
'GW624900',
'GW627000',
'GW627100',
'GW627200',
'GW627300',
'GW627400',
'GW627500',
'GW627600',
'GW627700',
'GW627800',
'GW627900',
'GW628000',
'GW628100',
'GW628200') -- and s.ReservationIndicator != ''
and s.RunsFrom <= '2019-07-28'
and s.RunsTo >= '2019-07-27'
and s.DayMask >= 32
order by s.RetailServiceId, s.id;

select l.TipLoc, l.ThreeLetterCode, l.Description, sl.*, s.*
from schedules s
inner join ScheduleLocations sl on s.id = sl.ScheduleId
inner join Locations l on sl.LocationId = l.Id
where s.toc = 'GW'
and s.RetailServiceId IN('GW617300') -- and s.ReservationIndicator != ''
and s.id in (29714, 1723831)
order by s.id, sl.id;

select distinct st.ThreeLetterCode, st.Description
from Schedules s
inner join ScheduleLocations sl on s.id = sl.ScheduleId
inner join Locations l on sl.LocationId = l.Id
inner join Stations st on st.TipLoc = l.TipLoc
where st.InterchangeStatus != 9
and s.SeatClass = 'B'
and s.ReservationIndicator != ''
and s.RetailServiceId IN ('GW413800', 'GW420300', 'GW417900', 'GW417800', 'GW417700',
       'GW417600', 'GW417500', 'GW417400', 'GW417300', 'GW417200',
       'GW417100', 'GW415000', 'GW414900', 'GW414800', 'GW414700',
       'GW414600', 'GW414500', 'GW414400', 'GW418000', 'GW418100',
       'GW418200', 'GW417000', 'GW420900', 'GW420500', 'GW420800',
       'GW421200', 'GW421100', 'GW421000', 'GW420100', 'GW420200',
       'GW422900', 'GW422800', 'GW422700', 'GW422600', 'GW422100',
       'GW424100', 'GW424300', 'GW421300', 'GW423000', 'GW424400',
       'GW428100', 'GW428000', 'GW427900', 'GW427800', 'GW427700',
       'GW427600', 'GW427500', 'GW427400', 'GW427300', 'GW427200',
       'GW428200', 'GW423100', 'GW423200', 'GW423400', 'GW418400',
       'GW420000', 'GW418500', 'GW414200', 'GW424200', 'GW424000',
       'GW423900', 'GW423800', 'GW423700', 'GW423600', 'GW423500',
       'GW427100', 'GW420600', 'GW310400', 'GW310300', 'GW310200',
       'GW310700', 'GW311000', 'GW311100', 'GW120700', 'GW310100',
       'GW121600', 'GW610100', 'GW123400', 'GW113000', 'GW310600',
       'GW314500', 'GW320100', 'GW314400', 'GW314300', 'GW314100',
       'GW314000', 'GW310500', 'GW311300', 'GW311200', 'GW116000',
       'GW122200', 'GW110400', 'GW127500', 'GW127000', 'GW126800',
       'GW126200', 'GW126100', 'GW321000', 'GW420700', 'GW320200',
       'GW110100', 'GW120100', 'GW623000', 'GW116600', 'GW427000',
       'GW424700', 'GW412100', 'GW412000', 'GW411900', 'GW412200',
       'GW412300', 'GW411000', 'GW413900', 'GW413700', 'GW413600',
       'GW413500', 'GW413400', 'GW320700', 'GW324300', 'GW410100',
       'GW324600', 'GW324500', 'GW324400', 'GW324200', 'GW324100',
       'GW324000', 'GW321400', 'GW321300', 'GW321200', 'GW321100',
       'GW414000', 'GW413300', 'GW413200', 'GW413000', 'GW411100',
       'GW411400', 'GW411600', 'GW411800', 'GW411700', 'GW411500',
       'GW424800', 'GW412900', 'GW412800', 'GW412700', 'GW412600',
       'GW412500', 'GW411300', 'GW411200', 'GW413100', 'GW320400',
       'GW422000', 'GW421900', 'GW421800', 'GW421700', 'GW414300',
       'GW414100', 'GW410600', 'GW410500', 'GW421600', 'GW424600',
       'GW424500', 'GW421500', 'GW421400', 'GW410400', 'GW410700',
       'GW410200', 'GW320600', 'GW320500', 'GW410800', 'GW410300',
       'GW410900', 'GW744700', 'GW742500', 'GW742700', 'GW742800',
       'GW742900', 'GW743200', 'GW743100', 'GW744200', 'GW744100',
       'GW743300', 'GW750400', 'GW744000', 'GW743000', 'GW744800',
       'GW740300', 'GW740200', 'GW740500', 'GW744300', 'GW745000',
       'GW744400', 'GW750600', 'GW744600', 'GW750700', 'GW750900',
       'GW751200', 'GW731100', 'GW751100', 'GW740100', 'GW751000',
       'GW744500', 'GW750000', 'GW734400', 'GW752000', 'GW731300',
       'GW751500', 'GW760300', 'GW731200', 'GW760000', 'GW734300',
       'GW734500', 'GW734600', 'GW734700', 'GW734900', 'GW735000',
       'GW735100', 'GW735200', 'GW734800', 'GW731400', 'GW744900',
       'GW734200', 'GW756000', 'GW740800', 'GW732700', 'GW756100',
       'GW734000', 'GW733300', 'GW733200', 'GW733100', 'GW733000',
       'GW732900', 'GW732800', 'GW732600', 'GW732500', 'GW732400',
       'GW732300', 'GW752400', 'GW732200', 'GW732100', 'GW753400',
       'GW732000', 'GW753700', 'GW766200', 'GW741200', 'GW750800',
       'GW730900', 'GW731000', 'GW760600', 'GW760900', 'GW760700',
       'GW760800', 'GW760400', 'GW730700', 'GW741300', 'GW741400',
       'GW740600', 'GW761300', 'GW730800', 'GW740900', 'GW761200',
       'GW760500', 'GW740700', 'GW762200', 'GW730300', 'GW763700',
       'GW742000', 'GW742100', 'GW742200', 'GW742300', 'GW742400',
       'GW766100', 'GW730100', 'GW730200', 'GW764600', 'GW763900',
       'GW761800', 'GW741000', 'GW741100', 'GW730600', 'GW750300',
       'GW750200', 'GW750100', 'GW753900', 'GW751300', 'GW761700',
       'GW761600', 'GW754100', 'GW761900', 'GW762100', 'GW753800',
       'GW741500', 'GW751800', 'GW752100', 'GW753300', 'GW751700',
       'GW751900', 'GW751600', 'GW752300', 'GW753600', 'GW753500',
       'GW752200', 'GW753200', 'GW761400', 'GW754000', 'GW762300',
       'GW766300', 'GW761000', 'GW730400', 'GW766000', 'GW764800',
       'GW764700', 'GW761100', 'GW764400', 'GW764300', 'GW764100',
       'GW764000', 'GW763800', 'GW763500', 'GW763400', 'GW763200',
       'GW762900', 'GW763600', 'GW760200', 'GW756200', 'GW754200',
       'GW755300', 'GW755200', 'GW755100', 'GW754400', 'GW754300',
       'GW722000', 'GW722100', 'GW722200', 'GW722300', 'GW722400',
       'GW724000', 'GW722600', 'GW724200', 'GW720900', 'GW724300',
       'GW724400', 'GW722500', 'GW720700', 'GW720800', 'GW720000',
       'GW720600', 'GW720500', 'GW720400', 'GW720300', 'GW720100',
       'GW720200', 'GW724100', 'GW710600', 'GW713500', 'GW710700',
       'GW713400', 'GW713300', 'GW713200', 'GW713100', 'GW713000',
       'GW711600', 'GW711400', 'GW711300', 'GW711200', 'GW711100',
       'GW711000', 'GW711500', 'GW710900', 'GW710800', 'GW710300',
       'GW710500', 'GW710400', 'GW713600', 'GW710100', 'GW710200',
       'GW622100', 'GW622000', 'GW621500', 'GW620900', 'GW621000',
       'GW623100', 'GW623200', 'GW621600', 'GW623400', 'GW621700',
       'GW623300', 'GW621900', 'GW611500', 'GW623600', 'GW623500',
       'GW621200', 'GW621300', 'GW621800', 'GW621100', 'GW611600',
       'GW617700', 'GW510800', 'GW520700', 'GW520300', 'GW520200',
       'GW520100', 'GW620800', 'GW620700', 'GW621400', 'GW620600',
       'GW616600', 'GW620500', 'GW620300', 'GW620200', 'GW616700',
       'GW620100', 'GW617900', 'GW617800', 'GW611900', 'GW617300',
       'GW617500', 'GW617400', 'GW617000', 'GW617200', 'GW617100',
       'GW616800', 'GW616900', 'GW617600', 'GW616500', 'GW611800',
       'GW612000', 'GW613400', 'GW613300', 'GW613200', 'GW613000',
       'GW612100', 'GW612900', 'GW612800', 'GW612600', 'GW613500',
       'GW613600', 'GW613900', 'GW613700', 'GW614000', 'GW613100',
       'GW610700', 'GW520900', 'GW610200', 'GW522000', 'GW610300',
       'GW520800', 'GW611200', 'GW611100', 'GW611300', 'GW611400',
       'GW628000', 'GW627900', 'GW627700', 'GW627600', 'GW627500',
       'GW627400', 'GW627300', 'GW627800', 'GW628100', 'GW627100',
       'GW624100', 'GW624800', 'GW624600', 'GW624500', 'GW624400',
       'GW624300', 'GW627000', 'GW624900', 'GW610800', 'GW628200',
       'GW624000', 'GW610500', 'GW610600', 'GW627200', 'GW610400',
       'GW623800', 'GW520400', 'GW623900', 'GW510200', 'GW510400',
       'GW510300', 'GW520500', 'GW512100', 'GW510900', 'GW520600',
       'GW510100', 'GW510500', 'GW611000', 'GW610900', 'GW510700',
       'GW510600', 'GW221000', 'GW220500', 'GW220700', 'GW221200',
       'GW221100', 'GW220300', 'GW220400', 'GW220200', 'GW222000',
       'GW211000', 'GW210500', 'GW220100', 'GW220000', 'GW211600',
       'GW211100', 'GW210900', 'GW210800', 'GW210600', 'GW121400',
       'GW210300', 'GW210400', 'GW210200', 'GW210000', 'GW127400',
       'GW127300', 'GW127200', 'GW127100', 'GW126900', 'GW126700',
       'GW126600', 'GW126500', 'GW126400', 'GW126000', 'GW125900',
       'GW125800', 'GW123600', 'GW123500', 'GW123300', 'GW123200',
       'GW123100', 'GW123000', 'GW122900', 'GW122800', 'GW122700',
       'GW122600', 'GW122500', 'GW122400', 'GW122300', 'GW122100',
       'GW122000', 'GW121700', 'GW121500', 'GW121200', 'GW111200',
       'GW121300', 'GW116100', 'GW121100', 'GW120600', 'GW121000',
       'GW120800', 'GW120200', 'GW126300', 'GW120300', 'GW120500',
       'GW117000', 'GW117500', 'GW117400', 'GW117300', 'GW117200',
       'GW117100', 'GW116200', 'GW116900', 'GW116800', 'GW116700',
       'GW116500', 'GW116400', 'GW116300', 'GW113600', 'GW113300',
       'GW113200', 'GW113100', 'GW112900', 'GW112800', 'GW112700',
       'GW112600', 'GW112500', 'GW112400', 'GW112100', 'GW111500',
       'GW111400', 'GW111300', 'GW111000', 'GW111100', 'GW110900',
       'GW110500', 'GW110200', 'GW110000', 'GW113400')
and not (sl.PublicArrival is null and sl.PublicDeparture is null)
-- group by st.ThreeLetterCode, st.Description
order by st.Description;

select s.retailserviceid, s.RunsFrom, s.StpIndicator, s.PowerType, o.ThreeLetterCode origin, d.ThreeLetterCode destination
from schedules s
inner join ScheduleLocations so on s.id = so.ScheduleId
inner join Locations o on so.LocationId = o.Id
inner join ScheduleLocations sd on s.id = sd.ScheduleId
inner join Locations d on sd.LocationId = d.Id
where s.toc = 'GW'
and s.StpIndicator = 'P'
and so.Activities like 'TB%'
and sd.Activities like 'TF%'
and s.RetailServiceId IN ('GW413800', 'GW420300', 'GW417900', 'GW417800', 'GW417700',
       'GW417600', 'GW417500', 'GW417400', 'GW417300', 'GW417200',
       'GW417100', 'GW415000', 'GW414900', 'GW414800', 'GW414700',
       'GW414600', 'GW414500', 'GW414400', 'GW418000', 'GW418100',
       'GW418200', 'GW417000', 'GW420900', 'GW420500', 'GW420800',
       'GW421200', 'GW421100', 'GW421000', 'GW420100', 'GW420200',
       'GW422900', 'GW422800', 'GW422700', 'GW422600', 'GW422100',
       'GW424100', 'GW424300', 'GW421300', 'GW423000', 'GW424400',
       'GW428100', 'GW428000', 'GW427900', 'GW427800', 'GW427700',
       'GW427600', 'GW427500', 'GW427400', 'GW427300', 'GW427200',
       'GW428200', 'GW423100', 'GW423200', 'GW423400', 'GW418400',
       'GW420000', 'GW418500', 'GW414200', 'GW424200', 'GW424000',
       'GW423900', 'GW423800', 'GW423700', 'GW423600', 'GW423500',
       'GW427100', 'GW420600', 'GW310400', 'GW310300', 'GW310200',
       'GW310700', 'GW311000', 'GW311100', 'GW120700', 'GW310100',
       'GW121600', 'GW610100', 'GW123400', 'GW113000', 'GW310600',
       'GW314500', 'GW320100', 'GW314400', 'GW314300', 'GW314100',
       'GW314000', 'GW310500', 'GW311300', 'GW311200', 'GW116000',
       'GW122200', 'GW110400', 'GW127500', 'GW127000', 'GW126800',
       'GW126200', 'GW126100', 'GW321000', 'GW420700', 'GW320200',
       'GW110100', 'GW120100', 'GW623000', 'GW116600', 'GW427000',
       'GW424700', 'GW412100', 'GW412000', 'GW411900', 'GW412200',
       'GW412300', 'GW411000', 'GW413900', 'GW413700', 'GW413600',
       'GW413500', 'GW413400', 'GW320700', 'GW324300', 'GW410100',
       'GW324600', 'GW324500', 'GW324400', 'GW324200', 'GW324100',
       'GW324000', 'GW321400', 'GW321300', 'GW321200', 'GW321100',
       'GW414000', 'GW413300', 'GW413200', 'GW413000', 'GW411100',
       'GW411400', 'GW411600', 'GW411800', 'GW411700', 'GW411500',
       'GW424800', 'GW412900', 'GW412800', 'GW412700', 'GW412600',
       'GW412500', 'GW411300', 'GW411200', 'GW413100', 'GW320400',
       'GW422000', 'GW421900', 'GW421800', 'GW421700', 'GW414300',
       'GW414100', 'GW410600', 'GW410500', 'GW421600', 'GW424600',
       'GW424500', 'GW421500', 'GW421400', 'GW410400', 'GW410700',
       'GW410200', 'GW320600', 'GW320500', 'GW410800', 'GW410300',
       'GW410900', 'GW744700', 'GW742500', 'GW742700', 'GW742800',
       'GW742900', 'GW743200', 'GW743100', 'GW744200', 'GW744100',
       'GW743300', 'GW750400', 'GW744000', 'GW743000', 'GW744800',
       'GW740300', 'GW740200', 'GW740500', 'GW744300', 'GW745000',
       'GW744400', 'GW750600', 'GW744600', 'GW750700', 'GW750900',
       'GW751200', 'GW731100', 'GW751100', 'GW740100', 'GW751000',
       'GW744500', 'GW750000', 'GW734400', 'GW752000', 'GW731300',
       'GW751500', 'GW760300', 'GW731200', 'GW760000', 'GW734300',
       'GW734500', 'GW734600', 'GW734700', 'GW734900', 'GW735000',
       'GW735100', 'GW735200', 'GW734800', 'GW731400', 'GW744900',
       'GW734200', 'GW756000', 'GW740800', 'GW732700', 'GW756100',
       'GW734000', 'GW733300', 'GW733200', 'GW733100', 'GW733000',
       'GW732900', 'GW732800', 'GW732600', 'GW732500', 'GW732400',
       'GW732300', 'GW752400', 'GW732200', 'GW732100', 'GW753400',
       'GW732000', 'GW753700', 'GW766200', 'GW741200', 'GW750800',
       'GW730900', 'GW731000', 'GW760600', 'GW760900', 'GW760700',
       'GW760800', 'GW760400', 'GW730700', 'GW741300', 'GW741400',
       'GW740600', 'GW761300', 'GW730800', 'GW740900', 'GW761200',
       'GW760500', 'GW740700', 'GW762200', 'GW730300', 'GW763700',
       'GW742000', 'GW742100', 'GW742200', 'GW742300', 'GW742400',
       'GW766100', 'GW730100', 'GW730200', 'GW764600', 'GW763900',
       'GW761800', 'GW741000', 'GW741100', 'GW730600', 'GW750300',
       'GW750200', 'GW750100', 'GW753900', 'GW751300', 'GW761700',
       'GW761600', 'GW754100', 'GW761900', 'GW762100', 'GW753800',
       'GW741500', 'GW751800', 'GW752100', 'GW753300', 'GW751700',
       'GW751900', 'GW751600', 'GW752300', 'GW753600', 'GW753500',
       'GW752200', 'GW753200', 'GW761400', 'GW754000', 'GW762300',
       'GW766300', 'GW761000', 'GW730400', 'GW766000', 'GW764800',
       'GW764700', 'GW761100', 'GW764400', 'GW764300', 'GW764100',
       'GW764000', 'GW763800', 'GW763500', 'GW763400', 'GW763200',
       'GW762900', 'GW763600', 'GW760200', 'GW756200', 'GW754200',
       'GW755300', 'GW755200', 'GW755100', 'GW754400', 'GW754300',
       'GW722000', 'GW722100', 'GW722200', 'GW722300', 'GW722400',
       'GW724000', 'GW722600', 'GW724200', 'GW720900', 'GW724300',
       'GW724400', 'GW722500', 'GW720700', 'GW720800', 'GW720000',
       'GW720600', 'GW720500', 'GW720400', 'GW720300', 'GW720100',
       'GW720200', 'GW724100', 'GW710600', 'GW713500', 'GW710700',
       'GW713400', 'GW713300', 'GW713200', 'GW713100', 'GW713000',
       'GW711600', 'GW711400', 'GW711300', 'GW711200', 'GW711100',
       'GW711000', 'GW711500', 'GW710900', 'GW710800', 'GW710300',
       'GW710500', 'GW710400', 'GW713600', 'GW710100', 'GW710200',
       'GW622100', 'GW622000', 'GW621500', 'GW620900', 'GW621000',
       'GW623100', 'GW623200', 'GW621600', 'GW623400', 'GW621700',
       'GW623300', 'GW621900', 'GW611500', 'GW623600', 'GW623500',
       'GW621200', 'GW621300', 'GW621800', 'GW621100', 'GW611600',
       'GW617700', 'GW510800', 'GW520700', 'GW520300', 'GW520200',
       'GW520100', 'GW620800', 'GW620700', 'GW621400', 'GW620600',
       'GW616600', 'GW620500', 'GW620300', 'GW620200', 'GW616700',
       'GW620100', 'GW617900', 'GW617800', 'GW611900', 'GW617300',
       'GW617500', 'GW617400', 'GW617000', 'GW617200', 'GW617100',
       'GW616800', 'GW616900', 'GW617600', 'GW616500', 'GW611800',
       'GW612000', 'GW613400', 'GW613300', 'GW613200', 'GW613000',
       'GW612100', 'GW612900', 'GW612800', 'GW612600', 'GW613500',
       'GW613600', 'GW613900', 'GW613700', 'GW614000', 'GW613100',
       'GW610700', 'GW520900', 'GW610200', 'GW522000', 'GW610300',
       'GW520800', 'GW611200', 'GW611100', 'GW611300', 'GW611400',
       'GW628000', 'GW627900', 'GW627700', 'GW627600', 'GW627500',
       'GW627400', 'GW627300', 'GW627800', 'GW628100', 'GW627100',
       'GW624100', 'GW624800', 'GW624600', 'GW624500', 'GW624400',
       'GW624300', 'GW627000', 'GW624900', 'GW610800', 'GW628200',
       'GW624000', 'GW610500', 'GW610600', 'GW627200', 'GW610400',
       'GW623800', 'GW520400', 'GW623900', 'GW510200', 'GW510400',
       'GW510300', 'GW520500', 'GW512100', 'GW510900', 'GW520600',
       'GW510100', 'GW510500', 'GW611000', 'GW610900', 'GW510700',
       'GW510600', 'GW221000', 'GW220500', 'GW220700', 'GW221200',
       'GW221100', 'GW220300', 'GW220400', 'GW220200', 'GW222000',
       'GW211000', 'GW210500', 'GW220100', 'GW220000', 'GW211600',
       'GW211100', 'GW210900', 'GW210800', 'GW210600', 'GW121400',
       'GW210300', 'GW210400', 'GW210200', 'GW210000', 'GW127400',
       'GW127300', 'GW127200', 'GW127100', 'GW126900', 'GW126700',
       'GW126600', 'GW126500', 'GW126400', 'GW126000', 'GW125900',
       'GW125800', 'GW123600', 'GW123500', 'GW123300', 'GW123200',
       'GW123100', 'GW123000', 'GW122900', 'GW122800', 'GW122700',
       'GW122600', 'GW122500', 'GW122400', 'GW122300', 'GW122100',
       'GW122000', 'GW121700', 'GW121500', 'GW121200', 'GW111200',
       'GW121300', 'GW116100', 'GW121100', 'GW120600', 'GW121000',
       'GW120800', 'GW120200', 'GW126300', 'GW120300', 'GW120500',
       'GW117000', 'GW117500', 'GW117400', 'GW117300', 'GW117200',
       'GW117100', 'GW116200', 'GW116900', 'GW116800', 'GW116700',
       'GW116500', 'GW116400', 'GW116300', 'GW113600', 'GW113300',
       'GW113200', 'GW113100', 'GW112900', 'GW112800', 'GW112700',
       'GW112600', 'GW112500', 'GW112400', 'GW112100', 'GW111500',
       'GW111400', 'GW111300', 'GW111000', 'GW111100', 'GW110900',
       'GW110500', 'GW110200', 'GW110000', 'GW113400')
and (s.RunsFrom < '2019-07-29' and s.RunsTo > '2019-07-29')
and s.DayMask & 1 = 1
order by s.RetailServiceId, s.id;

select distinct s.*
from Schedules s
inner join ScheduleLocations sl on s.id = sl.ScheduleId
inner join Locations l on sl.LocationId = l.Id
inner join Stations st on st.TipLoc = l.TipLoc
where st.InterchangeStatus != 9
and not (sl.PublicArrival is null and sl.PublicDeparture is null)
and st.ThreeLetterCode = 'RBU'
and s.RetailServiceId IN ('GW413800', 'GW420300', 'GW417900', 'GW417800', 'GW417700',
       'GW417600', 'GW417500', 'GW417400', 'GW417300', 'GW417200',
       'GW417100', 'GW415000', 'GW414900', 'GW414800', 'GW414700',
       'GW414600', 'GW414500', 'GW414400', 'GW418000', 'GW418100',
       'GW418200', 'GW417000', 'GW420900', 'GW420500', 'GW420800',
       'GW421200', 'GW421100', 'GW421000', 'GW420100', 'GW420200',
       'GW422900', 'GW422800', 'GW422700', 'GW422600', 'GW422100',
       'GW424100', 'GW424300', 'GW421300', 'GW423000', 'GW424400',
       'GW428100', 'GW428000', 'GW427900', 'GW427800', 'GW427700',
       'GW427600', 'GW427500', 'GW427400', 'GW427300', 'GW427200',
       'GW428200', 'GW423100', 'GW423200', 'GW423400', 'GW418400',
       'GW420000', 'GW418500', 'GW414200', 'GW424200', 'GW424000',
       'GW423900', 'GW423800', 'GW423700', 'GW423600', 'GW423500',
       'GW427100', 'GW420600', 'GW310400', 'GW310300', 'GW310200',
       'GW310700', 'GW311000', 'GW311100', 'GW120700', 'GW310100',
       'GW121600', 'GW610100', 'GW123400', 'GW113000', 'GW310600',
       'GW314500', 'GW320100', 'GW314400', 'GW314300', 'GW314100',
       'GW314000', 'GW310500', 'GW311300', 'GW311200', 'GW116000',
       'GW122200', 'GW110400', 'GW127500', 'GW127000', 'GW126800',
       'GW126200', 'GW126100', 'GW321000', 'GW420700', 'GW320200',
       'GW110100', 'GW120100', 'GW623000', 'GW116600', 'GW427000',
       'GW424700', 'GW412100', 'GW412000', 'GW411900', 'GW412200',
       'GW412300', 'GW411000', 'GW413900', 'GW413700', 'GW413600',
       'GW413500', 'GW413400', 'GW320700', 'GW324300', 'GW410100',
       'GW324600', 'GW324500', 'GW324400', 'GW324200', 'GW324100',
       'GW324000', 'GW321400', 'GW321300', 'GW321200', 'GW321100',
       'GW414000', 'GW413300', 'GW413200', 'GW413000', 'GW411100',
       'GW411400', 'GW411600', 'GW411800', 'GW411700', 'GW411500',
       'GW424800', 'GW412900', 'GW412800', 'GW412700', 'GW412600',
       'GW412500', 'GW411300', 'GW411200', 'GW413100', 'GW320400',
       'GW422000', 'GW421900', 'GW421800', 'GW421700', 'GW414300',
       'GW414100', 'GW410600', 'GW410500', 'GW421600', 'GW424600',
       'GW424500', 'GW421500', 'GW421400', 'GW410400', 'GW410700',
       'GW410200', 'GW320600', 'GW320500', 'GW410800', 'GW410300',
       'GW410900', 'GW744700', 'GW742500', 'GW742700', 'GW742800',
       'GW742900', 'GW743200', 'GW743100', 'GW744200', 'GW744100',
       'GW743300', 'GW750400', 'GW744000', 'GW743000', 'GW744800',
       'GW740300', 'GW740200', 'GW740500', 'GW744300', 'GW745000',
       'GW744400', 'GW750600', 'GW744600', 'GW750700', 'GW750900',
       'GW751200', 'GW731100', 'GW751100', 'GW740100', 'GW751000',
       'GW744500', 'GW750000', 'GW734400', 'GW752000', 'GW731300',
       'GW751500', 'GW760300', 'GW731200', 'GW760000', 'GW734300',
       'GW734500', 'GW734600', 'GW734700', 'GW734900', 'GW735000',
       'GW735100', 'GW735200', 'GW734800', 'GW731400', 'GW744900',
       'GW734200', 'GW756000', 'GW740800', 'GW732700', 'GW756100',
       'GW734000', 'GW733300', 'GW733200', 'GW733100', 'GW733000',
       'GW732900', 'GW732800', 'GW732600', 'GW732500', 'GW732400',
       'GW732300', 'GW752400', 'GW732200', 'GW732100', 'GW753400',
       'GW732000', 'GW753700', 'GW766200', 'GW741200', 'GW750800',
       'GW730900', 'GW731000', 'GW760600', 'GW760900', 'GW760700',
       'GW760800', 'GW760400', 'GW730700', 'GW741300', 'GW741400',
       'GW740600', 'GW761300', 'GW730800', 'GW740900', 'GW761200',
       'GW760500', 'GW740700', 'GW762200', 'GW730300', 'GW763700',
       'GW742000', 'GW742100', 'GW742200', 'GW742300', 'GW742400',
       'GW766100', 'GW730100', 'GW730200', 'GW764600', 'GW763900',
       'GW761800', 'GW741000', 'GW741100', 'GW730600', 'GW750300',
       'GW750200', 'GW750100', 'GW753900', 'GW751300', 'GW761700',
       'GW761600', 'GW754100', 'GW761900', 'GW762100', 'GW753800',
       'GW741500', 'GW751800', 'GW752100', 'GW753300', 'GW751700',
       'GW751900', 'GW751600', 'GW752300', 'GW753600', 'GW753500',
       'GW752200', 'GW753200', 'GW761400', 'GW754000', 'GW762300',
       'GW766300', 'GW761000', 'GW730400', 'GW766000', 'GW764800',
       'GW764700', 'GW761100', 'GW764400', 'GW764300', 'GW764100',
       'GW764000', 'GW763800', 'GW763500', 'GW763400', 'GW763200',
       'GW762900', 'GW763600', 'GW760200', 'GW756200', 'GW754200',
       'GW755300', 'GW755200', 'GW755100', 'GW754400', 'GW754300',
       'GW722000', 'GW722100', 'GW722200', 'GW722300', 'GW722400',
       'GW724000', 'GW722600', 'GW724200', 'GW720900', 'GW724300',
       'GW724400', 'GW722500', 'GW720700', 'GW720800', 'GW720000',
       'GW720600', 'GW720500', 'GW720400', 'GW720300', 'GW720100',
       'GW720200', 'GW724100', 'GW710600', 'GW713500', 'GW710700',
       'GW713400', 'GW713300', 'GW713200', 'GW713100', 'GW713000',
       'GW711600', 'GW711400', 'GW711300', 'GW711200', 'GW711100',
       'GW711000', 'GW711500', 'GW710900', 'GW710800', 'GW710300',
       'GW710500', 'GW710400', 'GW713600', 'GW710100', 'GW710200',
       'GW622100', 'GW622000', 'GW621500', 'GW620900', 'GW621000',
       'GW623100', 'GW623200', 'GW621600', 'GW623400', 'GW621700',
       'GW623300', 'GW621900', 'GW611500', 'GW623600', 'GW623500',
       'GW621200', 'GW621300', 'GW621800', 'GW621100', 'GW611600',
       'GW617700', 'GW510800', 'GW520700', 'GW520300', 'GW520200',
       'GW520100', 'GW620800', 'GW620700', 'GW621400', 'GW620600',
       'GW616600', 'GW620500', 'GW620300', 'GW620200', 'GW616700',
       'GW620100', 'GW617900', 'GW617800', 'GW611900', 'GW617300',
       'GW617500', 'GW617400', 'GW617000', 'GW617200', 'GW617100',
       'GW616800', 'GW616900', 'GW617600', 'GW616500', 'GW611800',
       'GW612000', 'GW613400', 'GW613300', 'GW613200', 'GW613000',
       'GW612100', 'GW612900', 'GW612800', 'GW612600', 'GW613500',
       'GW613600', 'GW613900', 'GW613700', 'GW614000', 'GW613100',
       'GW610700', 'GW520900', 'GW610200', 'GW522000', 'GW610300',
       'GW520800', 'GW611200', 'GW611100', 'GW611300', 'GW611400',
       'GW628000', 'GW627900', 'GW627700', 'GW627600', 'GW627500',
       'GW627400', 'GW627300', 'GW627800', 'GW628100', 'GW627100',
       'GW624100', 'GW624800', 'GW624600', 'GW624500', 'GW624400',
       'GW624300', 'GW627000', 'GW624900', 'GW610800', 'GW628200',
       'GW624000', 'GW610500', 'GW610600', 'GW627200', 'GW610400',
       'GW623800', 'GW520400', 'GW623900', 'GW510200', 'GW510400',
       'GW510300', 'GW520500', 'GW512100', 'GW510900', 'GW520600',
       'GW510100', 'GW510500', 'GW611000', 'GW610900', 'GW510700',
       'GW510600', 'GW221000', 'GW220500', 'GW220700', 'GW221200',
       'GW221100', 'GW220300', 'GW220400', 'GW220200', 'GW222000',
       'GW211000', 'GW210500', 'GW220100', 'GW220000', 'GW211600',
       'GW211100', 'GW210900', 'GW210800', 'GW210600', 'GW121400',
       'GW210300', 'GW210400', 'GW210200', 'GW210000', 'GW127400',
       'GW127300', 'GW127200', 'GW127100', 'GW126900', 'GW126700',
       'GW126600', 'GW126500', 'GW126400', 'GW126000', 'GW125900',
       'GW125800', 'GW123600', 'GW123500', 'GW123300', 'GW123200',
       'GW123100', 'GW123000', 'GW122900', 'GW122800', 'GW122700',
       'GW122600', 'GW122500', 'GW122400', 'GW122300', 'GW122100',
       'GW122000', 'GW121700', 'GW121500', 'GW121200', 'GW111200',
       'GW121300', 'GW116100', 'GW121100', 'GW120600', 'GW121000',
       'GW120800', 'GW120200', 'GW126300', 'GW120300', 'GW120500',
       'GW117000', 'GW117500', 'GW117400', 'GW117300', 'GW117200',
       'GW117100', 'GW116200', 'GW116900', 'GW116800', 'GW116700',
       'GW116500', 'GW116400', 'GW116300', 'GW113600', 'GW113300',
       'GW113200', 'GW113100', 'GW112900', 'GW112800', 'GW112700',
       'GW112600', 'GW112500', 'GW112400', 'GW112100', 'GW111500',
       'GW111400', 'GW111300', 'GW111000', 'GW111100', 'GW110900',
       'GW110500', 'GW110200', 'GW110000', 'GW113400');
order by st.Description;

select s.toc, s.SeatClass, count(*)
from schedules s
inner join ScheduleLocations so on s.id = so.ScheduleId
inner join Locations o on so.LocationId = o.Id
inner join ScheduleLocations sd on s.id = sd.ScheduleId
inner join Locations d on sd.LocationId = d.Id
where so.Activities like 'TB%'
and sd.Activities like 'TF%'
and (o.ThreeLetterCode = 'PAD' or d.ThreeLetterCode = 'PAD')
and s.StpIndicator = 'P'
and (s.DayMask & 4 = 4)
group by s.toc, s.SeatClass;

select s.SeatClass, count(*)
from schedules s
where s.toc = 'GW'
and s.StpIndicator = 'P'
group by s.SeatClass;